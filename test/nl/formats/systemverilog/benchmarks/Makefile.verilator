# Shared Verilator simulation rules for SV benchmarks.
# Each benchmark Makefile defines TOP, SV, TB then includes this file.

VERILATOR ?= verilator
OBJ_DIR   := obj_dir
VBIN      := $(OBJ_DIR)/V$(TOP)

.PHONY: sim clean

sim: $(VBIN)
	./$(VBIN)
	@echo "PASS: $(TOP)"

$(VBIN): $(SV) $(TB)
	$(VERILATOR) --cc --exe --build --top-module $(TOP) -j 0 -o V$(TOP) $(SV) $(TB)

clean:
	rm -rf $(OBJ_DIR)
